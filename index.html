<html>
<body>
<div>
  <input type="button" name="update_location" value="Update Location" onclick="updateLocation();"/>
  <iframe src="https://www.ddboline.net/weather/index.html" id="weather-frame" height="50" width="100" align="center"></iframe>
  <script>
    !function() {
      let textarea = document.getElementById('weather-frame');
      if (textarea) {
        if (textarea.getAttribute('height')) {
          textarea.setAttribute('height', Math.floor(window.innerHeight * 270 / 856.));
        }
        if (textarea.getAttribute('width')) {
          textarea.setAttribute('width', Math.floor(window.innerWidth * 850 / 1105.));
        }
      }
    }();
    function updateLocation() {
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(
        function success(position) {
          console.log("Got position " + position.coords.latitude + " " + position.coords.longitude);
          let url = "https://www.ddboline.net/weather/index.html?lat=" + position.coords.latitude + "&lon=" + position.coords.longitude;
          console.log("url " + url);
          let xmlhttp = new XMLHttpRequest();
          xmlhttp.onload = function() {
            document.getElementById('weather-frame').innerHTML = xmlhttp.responseText;
          }
          xmlhttp.open("GET", url, true);
          xmlhttp.send(null);
        },
        function error(error_message) {
          // for when getting location results in an error
          console.error('No location retreived', error_message)
        });
      }
    }
  </script>
</div>
</body>
